<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Prompt Recorder</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin-top: 30px; }
#logo {
  display: block;
  margin: 0 auto 40px;
  width: 480px; /* Match videoPreview width */
  max-width: 100%; /* Scale down on smaller screens */
  margin-bottom: 60px;
}
    #prompt { font-size: 24px; margin-bottom: 20px; }
   
    #videoPreview {
      width: 480px;
      height: 360px;
      margin: 20px auto;
      border: 2px solid #ccc;
      display: block;
    }
    #downloadLink, #stopButton {
      margin-top: 20px;
      display: none;
    }
   <button id="startButton" onclick="startApp()">Start Prompt</button>
<button id="resetButton" onclick="resetApp()">Reset for Testing</button>

   button {
  padding: 10px 20px;
  font-size: 16px;
  margin-top: 20px;
}

#startButton {
  margin-bottom: 40px;
}
  </style>
</head>
<body>
  <img src="images/logo.png" alt="Your Logo" id="logo">
  <button onclick="startApp()">Start Prompt</button>
  <div id="prompt">Get ready...</div>
  <video id="videoPreview" autoplay muted playsinline></video>
  <p id="status">Preparing to record...</p>
  <button id="stopButton">Stop Recording</button>
  <br>
  <a id="downloadLink" href="#" download="recording.webm">Download your recording</a>
#startButton {
  margin-bottom: 40px; /* Adjust the spacing as desired */
}
<script>
  let recordingCount = 0;
const MAX_RECORDINGS = 3; // Change this to your desired limit
  const prompts = [
    { text: "Describe your perfect day.", audio: "audio/prompt1.mp3" },
    { text: "What motivates you every morning?", audio: "audio/prompt2.mp3" },
    { text: "Talk about a childhood memory.", audio: "audio/prompt3.mp3" },
    { text: "What’s something new you’ve learned recently?", audio: "audio/prompt4.mp3" },
    { text: "Tell a story that made you laugh.", audio: "audio/prompt5.mp3" }
  ];

  const promptDisplay = document.getElementById('prompt');
  const videoPreview = document.getElementById('videoPreview');
  const statusDisplay = document.getElementById('status');
  const downloadLink = document.getElementById('downloadLink');
  const stopButton = document.getElementById('stopButton');

  const RECORDING_DURATION = 60000; // 60 seconds
  const COUNTDOWN_SECONDS = 3;      // Countdown before recording

  let mediaRecorder;
  let mediaStream;
  let chunks = [];
  let recordingTimeout;
function disableStartButton() {
  const startButton = document.getElementById('startButton');
  startButton.disabled = true;
  startButton.style.opacity = 0.5;
  startButton.style.cursor = 'not-allowed';
  statusDisplay.textContent = "Recording limit reached.";
}
 

function startApp() {
  if (recordingCount >= MAX_RECORDINGS) {
    alert("You’ve reached the maximum number of recordings.");
    disableStartButton();
    return;
  }

  const selectedPrompt = prompts[Math.floor(Math.random() * prompts.length)];
  promptDisplay.textContent = selectedPrompt.text;

  const audio = new Audio(selectedPrompt.audio);
  audio.play();

  audio.onended = () => {
    startCountdown(COUNTDOWN_SECONDS);
  };
}

function resetApp() {
  recordingCount = 0;

  const startButton = document.getElementById('startButton');
  startButton.disabled = false;
  startButton.style.opacity = 1;
  startButton.style.cursor = 'pointer';

  downloadLink.style.display = 'none';
  stopButton.style.display = 'none';
  promptDisplay.textContent = "Get ready...";
  statusDisplay.textContent = "Preparing to record...";
}

  function startCountdown(seconds) {
    if (seconds > 0) {
      statusDisplay.textContent = `Recording starts in ${seconds}...`;
      setTimeout(() => startCountdown(seconds - 1), 1000);
    } else {
      startRecording();
    }
  }

  function startRecording() {
    navigator.mediaDevices.getUserMedia({ video: true, audio: true }).then(stream => {
      mediaStream = stream;
      videoPreview.srcObject = stream;

      mediaRecorder = new MediaRecorder(stream);
      chunks = [];

     
      mediaRecorder.ondataavailable = e => chunks.push(e.data);
      mediaRecorder.onstop = () => {
        const blob = new Blob(chunks, { type: 'video/webm' });
        const url = URL.createObjectURL(blob);
        downloadLink.href = url;
        downloadLink.style.display = 'inline';
        stopButton.style.display = 'none';
        statusDisplay.textContent = "Recording finished!";
        stream.getTracks().forEach(track => track.stop());
      document.getElementById('status').textContent = `Recording ${recordingCount + 1} of ${MAX_RECORDINGS}`;

      };

      statusDisplay.textContent = "Recording started...";
mediaRecorder.start();
recordingCount++; // ⬅️ Add this line
       if (recordingCount >= MAX_RECORDINGS) {
      disableStartButton(); // ✅ Disable the button if limit reached
    }

stopButton.style.display = 'inline';

      // Automatically stop after time limit
      recordingTimeout = setTimeout(() => {
        stopRecording();
      }, RECORDING_DURATION);
    }).catch(error => {
      statusDisplay.textContent = "Error accessing camera/mic.";
      console.error(error);
    });
  }

  function stopRecording() {
    if (mediaRecorder && mediaRecorder.state === "recording") {
      mediaRecorder.stop();
      clearTimeout(recordingTimeout);
    }
  }

  stopButton.addEventListener('click', stopRecording);
</script>

</body>
</html>
